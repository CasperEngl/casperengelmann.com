---
import { CopyEmail } from './copy-email'
import * as home from '~/home.md'
import { obfuscate } from '~/utils/obfuscate'

let { title } = Astro.props
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>{title || 'Casper Engelmann'}</title>
	</head>
	<body class="dark:bg-black dark:text-white m-8">
		<slot />

		<footer class="mt-6">
			<!-- In case JS is not loaded, show the email anyways -->
			<noscript set:html={obfuscate(home.frontmatter.email)}></noscript>

			<!-- Enhance email copy experience -->
			<CopyEmail client:idle email={obfuscate(home.frontmatter.email)} />

			<p
				class="js-sorry text-gray-500 text-xs mt-1 max-w-sm cursor-zoom-in select-none"
			>
				Sorry but you'll have to copy this yourself, to protect me from
				spammers. If you have JavaScript enabled, clicking the email will select
				it for you.
			</p>
		</footer>

		<script is:inline>
			// Allow user to make the sorry text larger.
			const sorry = document.querySelector('.js-sorry')

			sorry.addEventListener('click', () => {
				if (sorry.classList.contains('cursor-zoom-in')) {
					sorry.classList.remove('cursor-zoom-in')
					sorry.classList.add('cursor-zoom-out')

					sorry.classList.remove('text-xs')
					sorry.classList.add('text-base')
				} else if (sorry.classList.contains('cursor-zoom-out')) {
					sorry.classList.remove('cursor-zoom-out')
					sorry.classList.add('cursor-zoom-in')

					sorry.classList.remove('text-base')
					sorry.classList.add('text-xs')
				}
			})
		</script>
	</body>
</html>
